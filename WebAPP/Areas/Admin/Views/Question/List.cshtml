@{
    ViewData["Active"] = "pageQuanLyCauHoi";
    ViewData["ActiveChild"] = "pageDanhsachcauhoi";
}

<div class="form-group mb-3">
    <label class="form-label">Chọn chủ đề & Phòng thi</label>
    <select class="form-control " id="categoryId" name="categoryId" style="overflow: hidden;">
        @foreach (var item in ViewBag.listcat)
        {
            <option value="@item.Value">@item.Text</option>
        }
    </select>
</div>
<ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="pills-tracnghiem-tab" data-bs-toggle="pill" data-bs-target="#pills-tracnghiem" type="button" role="tab" aria-controls="pills-tracnghiem" aria-selected="true">
            <i class="bi-folder2-open"></i>
            Phần trắc nghiệm:
            <span id="countTracNghiem" style="vertical-align:baseline"></span>
            câu hỏi
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="pills-tuluan-tab" data-bs-toggle="pill" data-bs-target="#pills-tuluan" type="button" role="tab" aria-controls="pills-tuluan" aria-selected="false">
            <i class="bi-folder2-open"></i>
            Phần tự luận:
            <span id="countTuLuan" style="vertical-align:baseline"></span>
            câu hỏi
        </button>
    </li>
</ul>
<div class="tab-content" id="pills-tabContent">
    <div class="tab-pane fade show active" id="pills-tracnghiem" role="tabpanel" aria-labelledby="pills-tracnghiem-tab">
        <div id="listQuestion"></div>
    </div>
    <div class="tab-pane fade" id="pills-tuluan" role="tabpanel" aria-labelledby="pills-tuluan-tab" >
        <div id="listQuestionTuLuan"></div>
    </div>
</div>


<script>
    $(document).ready(function () {
        var firstselect = $("select[name='categoryId']").val();
        $.ajax({
            url: "GetAllByCategoryId",
            type: "POST",
            data: {
                id: firstselect,
            },
            success: function (result) {
                $("#listQuestion").html(result);
            },
        });
        $.ajax({
            url: "GetAllTuLuanByCategoryId",
            type: "POST",
            data: {
                id: firstselect,
            },
            success: function (result) {
                $("#listQuestionTuLuan").html(result);
            },
        });
        $.ajax({
            url: "CountTracNghiem",
            type: "POST",
            data: {
                id: firstselect,
            },
            success: function (result) {
                $("#countTracNghiem").html(result.data);
            },
        });
        $.ajax({
            url: "CountTuLuan",
            type: "POST",
            data: {
                id: firstselect,
            },
            success: function (result) {
                $("#countTuLuan").html(result.data);
            },
        });



        $('#categoryId').on('change', function () {
            var id = $(this).val();
            $.ajax({
                url: "GetAllByCategoryId",
                type: "POST",
                data: {
                    id: id,
                },
                success: function (result) {
                    $("#listQuestion").html(result);
                },
            });
            $.ajax({
                url: "GetAllTuLuanByCategoryId",
                type: "POST",
                data: {
                    id: id,
                },
                success: function (result) {
                    $("#listQuestionTuLuan").html(result);
                },
            });
            $.ajax({
                url: "CountTracNghiem",
                type: "POST",
                data: {
                    id: id,
                },
                success: function (result) {
                    $("#countTracNghiem").html(result.data);
                },
            });
            $.ajax({
                url: "CountTuLuan",
                type: "POST",
                data: {
                    id: id,
                },
                success: function (result) {
                    $("#countTuLuan").html(result.data);
                },
            });
        })

    })
</script>
